<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:zxing="clr-namespace:ZXing.Net.Maui.Controls;assembly=ZXing.Net.MAUI.Controls"
             xmlns:vm="clr-namespace:AppTrackII.ViewModels"
             x:Class="AppTrackII.Pages.Scan.ScanPage"
             Title="Escáner">

    <ContentPage.BindingContext>
        <vm:ScanViewModel />
    </ContentPage.BindingContext>

    <Grid RowDefinitions="Auto, *, Auto" Padding="10">

        <Border Grid.Row="0" HeightRequest="250" StrokeShape="RoundRectangle 10" Margin="0,0,0,10">
            <zxing:CameraBarcodeReaderView
                IsDetecting="{Binding IsScanning}"
                BarcodesDetectedCommand="{Binding BarcodeDetectedCommand}" />
        </Border>

        <ScrollView Grid.Row="1">
            <VerticalStackLayout Spacing="15">

                <Label Text="Orden de Trabajo" FontSize="12" TextColor="Gray"/>
                <Frame Padding="10" BackgroundColor="#F0F0F0" BorderColor="Gray">
                    <Label Text="{Binding OrdenTrabajo}" 
                           FontSize="18" FontAttributes="Bold" TextColor="Black" 
                           HorizontalOptions="Center"/>
                </Frame>

                <Label Text="Número de Parte" FontSize="12" TextColor="Gray"/>
                <Frame Padding="10" BackgroundColor="#E3F2FD" BorderColor="#2196F3">
                    <Label Text="{Binding NumeroParte}" 
                           FontSize="18" FontAttributes="Bold" TextColor="#1565C0" 
                           HorizontalOptions="Center"/>
                </Frame>

                <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="10" RowSpacing="10">

                    <Frame Grid.Column="0" Padding="10" BorderColor="LightGray">
                        <VerticalStackLayout>
                            <Label Text="Familia" FontSize="10" TextColor="Gray"/>
                            <Label Text="{Binding Familia}" FontAttributes="Bold" TextColor="Black"/>
                        </VerticalStackLayout>
                    </Frame>

                    <Frame Grid.Column="1" Padding="10" BorderColor="LightGray">
                        <VerticalStackLayout>
                            <Label Text="Sub-Familia" FontSize="10" TextColor="Gray"/>
                            <Label Text="{Binding SubFamilia}" FontAttributes="Bold" TextColor="Black"/>
                        </VerticalStackLayout>
                    </Frame>

                    <Frame Grid.Row="1" Grid.ColumnSpan="2" Padding="10" BorderColor="LightGray">
                        <VerticalStackLayout>
                            <Label Text="Área / Ubicación" FontSize="10" TextColor="Gray"/>
                            <Label Text="{Binding Area}" FontSize="16" FontAttributes="Bold" TextColor="Green"/>
                        </VerticalStackLayout>
                    </Frame>
                </Grid>

                <ActivityIndicator IsRunning="{Binding IsBusy}" Color="#2196F3" HorizontalOptions="Center"/>

            </VerticalStackLayout>
        </ScrollView>

        <Button Grid.Row="2" Text="Limpiar" Command="{Binding ClearCommand}" Margin="0,10,0,0"/>

    </Grid>
</ContentPage>